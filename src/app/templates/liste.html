<app-menu/>
<main>
  <app-cart/>
  <div class="main-body">
    <div style="flex: 3;">
      <div class="table1">
        <div class="scrollable-table">
          <table *ngIf="products.length > 0">
            <thead>
            <tr>
              <th>Détails</th>
              <th>Quantité</th>
              <th>Prix</th>
              <th></th>
            </tr>
            </thead>
            <tbody>
            <tr *ngFor="let product of products">
              <td>
                <div class="product-info">
                  <img [src]="product.imageUrl || 'assets/product.png'" class="product-picture" alt="Produit" />
                  <div class="product-text">
                    <p class="product-name">{{ product.name }}</p>
                    <p class="product-ref">Réf : {{ product.product_ref || 'N/A' }}</p>
                  </div>
                </div>
              </td>
              <td>
                <div class="quantity">
                  <i class="up">▲</i>
                  <span class="number">{{ product.stock }}</span>
                  <i class="down">▼</i>
                </div>
              </td>
              <td class="price-cell">{{ product.price }} Gondariary</td>
              <td>
                <img src="assets/cart.png" alt="Ajouter au panier" width="40" height="40"
                     (click)="openQuantityPopup(product)" />
              </td>
            </tr>
            </tbody>
          </table>
          <p *ngIf="products.length === 0">Aucun produit trouvé.</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Popup Quantité -->
  <div *ngIf="selectedProduct" class="modal">
    <div class="modal-content">
      <h3>Ajouter {{ selectedProduct.name }} au panier</h3>
      <label>Quantité :</label>
      <input type="number" [(ngModel)]="selectedQuantity" min="1" />
      <div class="modal-actions">
        <button (click)="addToCart()">Ajouter</button>
        <button (click)="cancelPopup()">Annuler</button>
      </div>
    </div>
  </div>
</main>
